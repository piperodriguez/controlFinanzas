<link rel="stylesheet" href="./css/bootstrap.min.css">
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
<script src="./js/bootstrap.min.js"></script>
<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">
      <img src="http://localhost:3000/uploads/icon.jpeg" alt="" width="69" class="d-inline-block align-text-top">
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDarkDropdown" aria-controls="navbarNavDarkDropdown" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavDarkDropdown">
      <ul class="navbar-nav">
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDarkDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            Listado Datos
          </a>
          <ul class="dropdown-menu dropdown-menu-light" aria-labelledby="navbarDarkDropdownMenuLink">
            <li><a class="nav-link" aria-current="page" href="/home">Listar Deuda</a></li>
            <li><a class="nav-link active" href="/productos">Listar Productos</a></li>
          </ul>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDarkDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            Registrar Datos
          </a>
          <ul class="dropdown-menu dropdown-menu-light" aria-labelledby="navbarDarkDropdownMenuLink">
            <li><a class="nav-link" aria-current="page" href="/crearDeuda">Registrar Deuda</a></li>
            <li><a class="nav-link active" aria-current="page" href="/crearProducto">Registrar Producto</a></li>
          </ul>
        </li>
        <li class="nav-item">
          <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">Salir</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
<section class="example mt-4">
 <div class="container">
  <div class="row align-items-start">
    <div class="col">
      <a href="/crearProducto" class="btn btn-light btn-lg" tabindex="-1" role="button" aria-disabled="true">Registrar Producto</a>
    </div>
  </div>
  <br>
  <div class="table-responsive" id="tabladatos">
    <!-- Tabla HTML -->
   </div>
 </div>
 <footer class="page-footer font-small blue">
    <div class="footer-copyright text-center py-3">
      © 2023 Control Financiero
    </div>
</footer>
</section>
<% if (locals.data != '') { %> 
    <div class="alert alert-primary" role="alert">
      <%= locals.data %> 
    </div>
<% } %>
   
<!-- Código Para Mostrar la Tabla con los datos -->
<script type="text/javascript">
    fetch("http://localhost:3000/api/v1/redirect/productos").then(response => {
        if(response.ok) {
            return response.json();
        }
    }).then(data => {
        if(data) {
            console.log(data); 

            const ar = data; 
              let result = `<table class='table table-striped table-bordered table-hover text-center'><thead class='table-dark'>
                            <tr>
                              <th>Producto</th>
                              <th>Imagen</th>
                              <th>Acciones</th>
                            </tr>
                            </thead><tbody>`;
              ar.forEach((elem) => {
                  result += `<tr>
                      <td class=v-align-middle>${elem.nombre}</td>
                      <td class=v-align-middle><img src=http://localhost:3000/uploads/${elem.img} class=img-fluid style=max-width:50px></td>
                      <td class=v-align-middle>

                        <form action="http://localhost:3000/api/v1/redirect/eliminar/${elem.id}" method="POST" onsubmit="return confirmarEliminar()">        

                          <a href="/detalle?id=${elem.id}" class="btn btn-secondary">Detalles</a>

                          <a href="/actualizar?id=${elem.id}" class="btn btn-primary">Editar</a>

                          <button type="submit" class="btn btn-danger">Eliminar</button>

                        </form>  

                      </td>
                    </tr>`
                    

              });
              result += `</tbody></table>`;
              document.getElementById("tabladatos").innerHTML = result;
         };
        }
    ).catch(err => console.error(err));      
  </script>

  <!-- Código Para eliminar un producto  -->
  <script type="text/javascript">
    function confirmarEliminar()
    {
    var x = confirm("Estas seguro de Eliminar?");
    if (x)
      return true;
    else
      return false;
    }
</script>
<script type="text/javascript">
    function confirmarEliminar() {
      var x = confirm("Estas seguro de Eliminar?");
      if (x) return true;
      else return false;
    }
  </script>
</body>